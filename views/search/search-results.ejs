<%- include('../includes/head.ejs') %>
<link rel="stylesheet" href="/assets/css/badges.css">
<link rel="stylesheet" href="/assets/css/search.css">

    </head>

    <body class="is-preload">

        <!-- Wrapper -->
        <div id="wrapper">

            <%- include('../includes/navigation.ejs') %>

            <!-- Main -->
            <div id="main">

                <section id="" class="box search-section">
                    <header>
                        <h2 class="search-heading">üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞<%= query ? ' –¥–ª—è "' + query + '"' : '' %></h2>
                        <% if (query && query.trim()) { %>
                        <p class="search-results-info">–ù–∞–π–¥–µ–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: <%= totalResults %></p>
                    </header>
                </section>


                <article class="post">
                    <% if (hasResults) { %>
                        <div class="search-results">
                            <ul class="search-results-list">
                            <% results.forEach(function(item) { %>
    <li class="search-results-item">
        <article>
            <header class="search-item-container">
                <div class="title">
                    <h2>
                        <a href="<%= item.searchType === 'guide' ? '/guides/' : '/posts/' %><%= item.id %>">
                            <%= item.title %>
                            <% if (item.searchType === 'guide') { %>
                                <span class="type-badge guide">–ì–∞–π–¥</span>
                            <% } else { %>
                                <span class="type-badge post">–ü–æ—Å—Ç</span>
                            <% } %>
                        </a>
                    </h2>
                    <p class="excerpt">
                        <%= item.content ? item.content.substring(0, 200) : (item.preview ? item.preview.substring(0, 200) : '') %> ...
                    </p>
                </div>
                <div class="meta search">
                    <% if (item.searchType === 'guide' && item.categories && item.categories.length > 0) { %>
                        <span class="category">
                            <%= item.categories[0].name %>
                        </span>
                    <% } else if (item.searchType === 'post' && item.category) { %>
                        <span class="category">
                            <%= item.category.name %>
                        </span>
                    <% } else { %>
                        <span class="category">
                            <%= item.searchType === 'guide' ? 'Guide' : 'Post' %>
                        </span>
                    <% } %>
                    <span class="type">
                        <%= item.searchType === 'guide' ? '–ì–∞–π–¥' : '–ü–æ—Å—Ç' %>
                    </span>
                </div>
            </header>

            <% if (item.tags && item.tags.length > 0) { %>
                <div class="tags">
                    <% item.tags.forEach(function(tag) { %>
                        <span class="tag">
                            <%= tag %>
                        </span>
                    <% }) %>
                </div>
            <% } %>
        </article>
    </li>
<% }) %>
                            </ul>
                        </div>
                        <% } else { %>
                        <div class="no-results">
                            <h3>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
                            <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –∫–ª—é—á–µ–≤—ã–µ
                                —Å–ª–æ–≤–∞.</p>
                        </div>
                        <% } %>
                            <% } else { %>
                                <div class="no-query">
                                    <h3>–í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</h3>
                                    <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º—É –≤—ã—à–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Å–∞–π—Ç–∞–º, –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –≥–∞–π–¥–∞–º.
                                    </p>
                                </div>
                            <% } %>

                </article>

                <%- include('../includes/search-pagination.ejs') %>

            
                    <!-- Pagination -->
                    <ul class="actions pagination">
                        <% let paginationUrl = '?query=' + encodeURIComponent(query);
                            if (categoryId) {
                                paginationUrl += '&category=' + categoryId;
                            }
                            if (type) {
                                paginationUrl += '&type=' + type;
                            } %>
                        <li><a href="<%= paginationUrl %>&page=<%= previousPage %>"
                                class="<%= hasPreviousPage ? '' : 'disabled' %> button large previous">Previous Page</a>
                        </li>
                        <li><a href="<%= paginationUrl %>&page=<%= nextPage %>"
                                class="<%= hasNextPage ? '' : 'disabled' %> button large next">Next Page</a></li>
                    </ul>

            </div>

            <!-- Sidebar -->
            <section id="sidebar">
             

            <section>
                <div class="mini-posts">
                           <!-- –§–∏–ª—å—Ç—Ä—ã -->
<% if (query && query.trim()) { %>
<section class="search-filters">
    <div class="filter-container">
        <h3>–§–∏–ª—å—Ç—Ä—ã</h3>
        <form method="get" action="/search" class="filter-form">
            <input type="hidden" name="query" value="<%= query %>">
            
            <div class="filter-group">
                <label for="type">–¢–∏–ø:</label>
                <select name="type" id="type" onchange="this.form.submit()">
                    <option value="" <%= !type ? 'selected' : '' %>>–í—Å–µ —Ç–∏–ø—ã</option>
                    <option value="posts" <%= type == 'posts' ? 'selected' : '' %>>–ü–æ—Å—Ç—ã</option>
                    <option value="guides" <%= type == 'guides' ? 'selected' : '' %>>–ì–∞–π–¥—ã</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                <select name="category" id="category" onchange="this.form.submit()">
                    <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                    <% categories.forEach(function(cat) { %>
                        <option value="<%= cat.id %>" <%= categoryId == cat.id ? 'selected' : '' %>>
                            <%= cat.name %>
                        </option>
                    <% }) %>
                </select>
            </div>
            
            <button type="submit" class="button small">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            <% if (categoryId || type) { %>
                <a href="?query=<%= encodeURIComponent(query) %>" class="button small">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</a>
            <% } %>
        </form>
    </div>
</section>
<% } %>
                </div>
            </section>

                <!-- Posts List -->
                <section>
                    <h3></h3>
                    <ul class="posts">

                        <li>
                            <article>
                                <header>
                                    <h3><a href="">

                                        </a></h3>
                                </header>
                                <a href="" class="image"><img src="" alt="" /></a>
                            </article>
                        </li>

                    </ul>
                </section>




<%- include('../includes/footer.ejs') %>


    </section>

</div>


<%- include('../includes/main-scripts.ejs') %>


<%- include('../includes/scripts.ejs') %>